

WITH
CTE_PADRON_2010
AS(
    SELECT 
        REPLACE(
            CONCAT(
                RTRIM(LTRIM(PrimerNombre)),
                SPACE(1),
                RTRIM(LTRIM(SegNombre)),
                SPACE(1),
                RTRIM(LTRIM(PrimerApellido)),
                SPACE(1),
                RTRIM(LTRIM(SegApellido))
            )
        ,'  ',' ') AS NOMBRE,
        cedulaEstract AS CEDULA,
        SUBSTRING(Cedula,16, LEN(CEDULA) - 15) AS IDX
    FROM REFCOMERCIAL.DBO.InfoPadron2010
)
-- *********************************************
-- *                                           *
-- *    SE REGISTRA EL PADRON 2010 EN LA BD    *
-- *                                           *
-- *********************************************
-- -- PROCEDENCIA 8 PADRON2010
-- INSERT INTO Persona 
-- (IdProcedencia,NOMBRE,CEDULA,ESTADO)
-- SELECT 
--     8 AS ProcePadron2010, 
--     A.Nombre,
--     A.Cedula, 
--     0 As Estado -- Inactivo pues no hay mas registros sobre ellos
-- FROM CTE_PADRON_2010 A
-- LEFT JOIN Persona B ON A.CEDULA = B.Cedula
-- WHERE B.Cedula IS NULL








-- select top 10 *
-- from Persona where IdProcedencia = 8
INSERT INTO Persona 
(IdProcedencia,NOMBRE,CEDULA,ESTADO)
SELECT 
    8 AS ProcePadron2010, 
    A.Nombre,
    A.Cedula, 
    0 As Estado -- Inactivo pues no hay mas registros sobre ellos
FROM CTE_PADRON_2010 A
LEFT JOIN Persona B ON A.CEDULA = B.Cedula
WHERE A.Cedula IN
 (
'0013108800080P',
'4512611880002V',
'0011801550054X',
'0012712920018Y',
'1611503920010N',
'0012811740038P',
'2010804800005K',
'0010601720096A',
'2020208750002P',
'0422407540000K',
'4410204670009V',
'0010803920001F',
'1612910860000L',
'1622512570000Q',
'3243012820000H',
'4411102920005M',
'0012304920046T',
'8882304910001B',
'4430111860002N',
'0011002840020S',
'2410209510006J',
'0811506780019C',
'6011106920000Q',
'4090212800001M',
'0011801940004G',
'6111004650000V',
'6012806910003L',
'0011108840040F',
'0812209860003B',
'1611402900000E',
'0011612910006S',
'2810807680001G',
'0881006860000Y',
'2022010860004J',
'4411609880004P',
'2810108900013R',
'1212505830007X',
'0012701540022N',
'2812812850009Y',
'0031606740001A',
'0012901860059J',
'1632307870000H',
'2812505790005A',
'0012901630009E',
'0011910910041Y',
'0011802660060B',
'0810406770017G',
'0811203870006N',
'0012103890017S',
'0012206920052L',
'0011402570049E',
'2811109800014A',
'1220303930000S',
'1612105920003G',
'4411712910003T',
'2812110920014N',
'0011004850015U',
'3613012840006W',
'2810910850006R',
'2812404900010M',
'0012103730017E',
'4500409900000E',
'0011803760069N',
'4812104920002P',
'2412604900007S',
'0011702900018X',
'0810507890001H',
'0842401660003P',
'4411810910005K',
'5662712820001L',
'0012007840054J',
'0032401720001V',
'1212604900002A',
'1281508670001X',
'0012801920020G',
'0070607830000E',
'2912806650000H',
'0012605900015J',
'0030206930000Q',
'2832603890001Q',
'0012505920025G',
'1270911840004X',
'0011308790073X',
'0012112890070J',
'4410409560007Q',
'0012209900046K',
'4511211900001D',
'0810408930001Q',
'4811009860000D',
'0031003870008E',
'6070111910002N',
'0012212930042J',
'2911011890000V',
'6040901830002G',
'0811110890009Y',
'0012005790021M',
'4862712890000F',
'2812112900007E',
'1221508550000H',
'0010909830062M',
'6032601830005E',
'0012008910051Y',
'6112907590000P',
'0012503900016U',
'0011911890054F',
'0010809900037U',
'0011903880002C',
'4471105620000T',
'0011012870053C',
'0011109920020W',
'0011707850015E',
'0013001900037Q',
'2011005750013G',
'3651612560001H',
'2411608740001C',
'0011711790081K',
'4013001900004L',
'1251809730000A',
'2411909830003T',
'0813007880001S',
'0012105900014W',
'2872002910000D',
'0860804680004Y',
'0011306820032Y',
'0012704620005V',
'2411407590003A',
'2011901900005K',
'2011511810006R',
'4412409880006J',
'2860602830000Y',
'2902203890000C',
'0011509870055V',
'0010811550091G',
'2410610740015J'
)
-- select top 10 *
-- from Persona where IdProcedencia = 8

